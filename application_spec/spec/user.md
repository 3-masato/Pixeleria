# 🧑 アカウント機能

## ユーザーアカウント

ユーザーアカウントについては以下の機能があります。

| 機能           | 内容                                                                                                                                                                                                                                                                |
| -------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 新規登録       | 新規登録には **表示名**, **アカウント名**, **メールアドレス**, **パスワード** が必要です。<br>マイページからユーザー編集画面に遷移し、**プロフィール画像** や **自己紹介文** を編集することが出来ます。<br>また、この編集画面で表示名とアカウント名も変更できます。 |
| ログイン       | ログインには **メールアドレス**, **パスワード** が必要です。                                                                                                                                                                                                        |
| ゲストログイン | 新規登録の手間を省くための機能です。<br>いくつかの差異はありますが、ほとんど一般ユーザーと同じように利用できます。                                                                                                                                                  |

## 🏷️ 表示名とアカウント名の違い

| 種類         | 説明                                                                                                                                                                      |
| ------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 表示名       | 他のユーザーに表示されるユーザーの名前です。                                                                                                                              |
| アカウント名 | アカウントを区別するためのユニークなユーザー名です。<br>ユーザープロフィールの URL に使われます。<br>半角数字、半角英大文字、半角英小文字、アンダースコアが使用できます。 |

## 👤 ゲストユーザーのと一般ユーザーの差異について

- メールアドレスとパスワードを `SecureRandom` で生成している
  - 同じアカウントでのログインは実質的に不可能といえます。
  - 同時刻に複数のゲストユーザーが存在していても問題ない仕組みとなっています。
- 定期的に削除される
  - バックグラウンドジョブを作成し、`whenever` で定期的に削除処理を実行しています。
  - ゲストユーザーのアカウント作成に必要な情報は自動生成なため、大量のゲストユーザーで溢れてしまうおそれがあります。
  - それを防ぐために定期的にアカウントの物理削除を行います。
- 名前横のバッジがない
  - 一般ユーザーとの視覚的な判別をするためです。
- 退会ができない
  - ゲストユーザーが退会を実行したとしても特に影響はないため、この制限については無くても良かったかもしれません。
  - 仕様の再検討が必要です。

これ以外は一般ユーザーと同じです。
プロフィールの変更やコメントなどは自由にできます。

## 👋 退会処理について

- ユーザー自体は、退会ステータスによる論理削除
- ユーザーの投稿作品、いいね、コメント、フォロー・フォロワーについては物理削除

## 👨‍💻 管理者アカウント

管理者アカウントは Seed で作成し、専用のフォームから **メールアドレス** と **パスワード** でログインします。
メールアドレスとパスワードは `.env` の `SEEDS_ADMIN_EMAIL` と `SEEDS_ADMIN_PASSWORD` を参照します。

## 📘 課題

- 現状、メールアドレスを確認する手段がないため、編集画面に表示させたほうが良いかもしれません。
- ゲストユーザーが削除されたタイミングで、そのゲストユーザーが作成したものも一緒に消えます。
  物理削除をせず、「退会済ユーザーによる投稿」のような形で残せるようにしたいと考えています。
- ユーザーステータスに「凍結」があります。
  凍結されたユーザーはログインすることは出来ません。
  ただし、凍結されたユーザーや投稿物諸々はそのまま表示されてしまうため、非表示にするなどの対処が必要です。
